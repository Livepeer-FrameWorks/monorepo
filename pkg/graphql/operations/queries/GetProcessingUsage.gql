# Fetch transcoding/processing usage records for analytics
# Returns detailed records and daily summaries for billing display
query GetProcessingUsage(
  $streamId: ID
  $processType: String
  $timeRange: TimeRangeInput
  $first: Int = 100
  $after: String
) {
  analytics {
    usage {
      processing {
        processingUsageConnection(streamId: $streamId, processType: $processType, timeRange: $timeRange, page: { first: $first, after: $after }) {
          edges {
            cursor
            node {
              id
              timestamp
              nodeId
              streamId
              stream {
                streamId
              }
              processType
              trackType
              durationMs
              inputCodec
              outputCodec
              width
              height
              outputWidth
              outputHeight
              outputFpsMeasured
              outputBitrateBps
              rtfOut
              pipelineLagMs
            }
          }
          pageInfo {
            hasNextPage
            endCursor
          }
          totalCount
          summaries {
            date
            livepeerSeconds
            livepeerSegmentCount
            livepeerUniqueStreams
            livepeerH264Seconds
            livepeerVp9Seconds
            livepeerAv1Seconds
            livepeerHevcSeconds
            nativeAvSeconds
            nativeAvSegmentCount
            nativeAvUniqueStreams
            nativeAvH264Seconds
            nativeAvVp9Seconds
            nativeAvAv1Seconds
            nativeAvHevcSeconds
            nativeAvAacSeconds
            nativeAvOpusSeconds
            audioSeconds
            videoSeconds
          }
        }
      }
    }
  }
}
