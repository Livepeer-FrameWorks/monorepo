# Combined network topology + federation traffic for the network dashboard page
# Requires authentication (returns tenant-scoped cluster traffic)
query GetNetworkOverview($timeRange: TimeRangeInput!) {
  networkStatus {
    clusters {
      clusterId
      name
      region
      latitude
      longitude
      nodeCount
      healthyNodeCount
      peerCount
      status
      clusterType
      shortDescription
      maxStreams
      currentStreams
      maxViewers
      currentViewers
      maxBandwidthMbps
      currentBandwidthMbps
    }
    peerConnections {
      sourceCluster
      targetCluster
      connected
    }
    nodes {
      nodeId
      name
      nodeType
      latitude
      longitude
      status
      clusterId
    }
    serviceInstances {
      instanceId
      serviceId
      clusterId
      nodeId
      status
      healthStatus
    }
    totalNodes
    healthyNodes
    updatedAt
  }
  analytics {
    infra {
      clusterTrafficMatrix(timeRange: $timeRange) {
        clusterId
        remoteClusterId
        eventCount
        successCount
        avgLatencyMs
        avgDistanceKm
        successRate
        localLatitude
        localLongitude
        remoteLatitude
        remoteLongitude
      }
      federationSummary(timeRange: $timeRange) {
        eventCounts {
          eventType
          count
          failureCount
          avgLatencyMs
        }
        totalEvents
        overallAvgLatencyMs
        overallFailureRate
      }
    }
  }
}
