# Fetch complete infrastructure overview including tenant, clusters, nodes, and node metrics
# Comprehensive query for infrastructure dashboard with resource utilization data
query GetInfrastructureOverview(
  $timeRange: TimeRangeInput
  $first: Int = 100
  $noCache: Boolean = false
) {
  tenant {
    id
    name
    cluster
    createdAt
  }
  clustersConnection(first: 50) {
    edges {
      cursor
      node {
        id
        clusterId
        clusterName
        clusterType
        deploymentModel
        baseUrl
        databaseUrl
        periscopeUrl
        kafkaBrokers
        maxConcurrentStreams
        maxConcurrentViewers
        maxBandwidthMbps
        currentStreamCount
        currentViewerCount
        currentBandwidthMbps
        healthStatus
        isActive
        isDefaultCluster
        isSubscribed
        createdAt
        updatedAt
        ownerTenantId
        visibility
        pricingModel
        monthlyPriceCents
        requiredBillingTier
        requiresApproval
        shortDescription
        longDescription
        isPlatformCluster
      }
    }
    pageInfo {
      ...PageInfoFields
    }
    totalCount
  }
  nodesConnection(first: 50) {
    edges {
      cursor
      node {
        ...NodeCoreFields
      }
    }
    pageInfo {
      ...PageInfoFields
    }
    totalCount
  }
  nodeMetrics1hConnection(
    timeRange: $timeRange
    first: $first
    noCache: $noCache
  ) {
    edges {
      cursor
      node {
        timestamp
        nodeId
        avgCpu
        peakCpu
        avgMemory
        peakMemory
        avgDisk
        peakDisk
        avgShm
        peakShm
        totalBandwidthIn
        totalBandwidthOut
        wasHealthy
      }
    }
    pageInfo {
      ...PageInfoFields
    }
    totalCount
  }
}
