# Real-time stream lifecycle events including status changes and state transitions
# Returns StreamSubscriptionEvent with rich proto payloads
subscription StreamEvents($stream: String) {
  streamEvents(stream: $stream) {
    eventType    # Proto enum: EVENT_TYPE_STREAM_LIFECYCLE_UPDATE, EVENT_TYPE_STREAM_END, EVENT_TYPE_STREAM_BUFFER
    timestamp
    # Rich payload - one of these will be populated based on eventType
    lifecycleUpdate {
      nodeId
      internalName
      status           # "live", "offline"
      bufferState      # "FULL", "EMPTY", "DRY", "RECOVER"
      uploadedBytes
      downloadedBytes
      totalViewers
      totalInputs
      viewerSeconds
    }
    endEvent {
      streamName
      nodeId
      downloadedBytes
      uploadedBytes
      totalViewers
      totalInputs
      totalOutputs
      viewerSeconds
    }
    # Rich health diagnostics - jitter, buffer depth, issues
    bufferEvent {
      streamName
      bufferState      # "FULL", "EMPTY", "DRY", "RECOVER"
      hasIssues
      issuesDescription
      trackCount
      qualityTier
      streamBufferMs   # Actual buffer depth in milliseconds
      streamJitterMs   # Max jitter across tracks (critical health signal)
      mistIssues       # Raw Mist issue string like "HLSnoaudio!"
      maxKeepawaMs     # How far behind viewers are from live edge
    }
  }
}
