# GraphQL schema location (shared schema)
schema:
  - ../pkg/graphql/schema.graphql

# Where should the generated server code go?
exec:
  filename: graph/generated/generated.go
  package: generated

# Where should any generated models go?
model:
  filename: graph/model/models_gen.go
  package: model

# Where should the resolver implementations go?
resolver:
  layout: follow-schema
  dir: graph
  package: graph
  filename_template: "{name}.resolvers.go"

# Optional: turn on or off automatic camelCase marshaling for field names
autobind:
  - frameworks/pkg/proto

# Map GraphQL types to existing Go models (comprehensive mapping)
# NOTE: Using pb.* proto types for all analytics/streaming types
models:
  # Analytics types - bound to proto types
  StreamAnalytics:
    model:
      - frameworks/pkg/proto.StreamAnalytics
  RoutingEvent:
    model:
      - frameworks/pkg/proto.RoutingEvent
  LoadBalancingMetric:
    model:
      - frameworks/pkg/proto.RoutingEvent
  ViewerMetric:
    model:
      - frameworks/pkg/proto.ViewerSession
  ViewerMetrics5m:
    model:
      - frameworks/pkg/proto.ViewerSession5M
  ConnectionEvent:
    model:
      - frameworks/pkg/proto.ConnectionEvent
  StreamHealthMetric:
    model:
      - frameworks/pkg/proto.StreamHealthMetric
  ViewerCountBucket:
    model:
      - frameworks/pkg/proto.ViewerCountBucket
  CountryMetric:
    model:
      - frameworks/pkg/proto.CountryMetric
  CountryMetrics:
    model:
      - frameworks/pkg/proto.CountryMetrics
  CityMetric:
    model:
      - frameworks/pkg/proto.CityMetric
  PlatformOverview:
    model:
      - frameworks/pkg/proto.GetPlatformOverviewResponse
  ViewerGeographic:
    model:
      - frameworks/pkg/proto.ConnectionEvent
  StreamEvent:
    model:
      - frameworks/pkg/proto.StreamEvent
  # Query types - bound to periscope.proto types (analytics API responses)
  TrackListEvent:
    model:
      - frameworks/pkg/proto.TrackListEvent
  ClipEvent:
    model:
      - frameworks/pkg/proto.ClipEvent
  ArtifactState:
    model:
      - frameworks/pkg/proto.ArtifactState
  StreamTrack:
    model:
      - frameworks/pkg/proto.StreamTrack

  # Pre-aggregated analytics types (Materialized Views)
  StreamConnectionHourly:
    model:
      - frameworks/pkg/proto.StreamConnectionHourly
  ClientMetrics5m:
    model:
      - frameworks/pkg/proto.ClientMetrics5M
  QualityTierDaily:
    model:
      - frameworks/pkg/proto.QualityTierDaily
  QualityChangesHourly:
    model:
      - frameworks/pkg/proto.QualityChangesHourly
  StorageUsageRecord:
    model:
      - frameworks/pkg/proto.StorageUsageRecord

  # Real-time subscription types - bound to ipc.proto types (raw Kafka events via Signalman)
  ViewerMetrics:
    model:
      - frameworks/pkg/proto.ClientLifecycleUpdate
  SystemHealthEvent:
    model:
      - frameworks/pkg/proto.NodeLifecycleUpdate
  DVREvent:
    model:
      - frameworks/pkg/proto.DVRLifecycleData
  TrackListUpdate:
    model:
      - frameworks/pkg/proto.StreamTrackListTrigger
  ClipLifecycle:
    model:
      - frameworks/pkg/proto.ClipLifecycleData

  # Stream management types - bound to proto types
  Stream:
    model:
      - frameworks/pkg/proto.Stream
  StreamMetrics:
    model:
      - frameworks/pkg/proto.StreamStatusResponse
  StreamKey:
    model:
      - frameworks/pkg/proto.StreamKey
  Recording:
    model:
      - frameworks/pkg/proto.Recording
  Clip:
    model:
      - frameworks/pkg/proto.ClipInfo
  ClipViewingUrls:
    model:
      - frameworks/pkg/proto.ClipViewingURLs
  DVRRequest:
    model:
      - frameworks/pkg/proto.DVRInfo

  # Viewer endpoint resolution types - bound to proto types
  ViewerEndpointResponse:
    model:
      - frameworks/pkg/proto.ViewerEndpointResponse
  ViewerEndpoint:
    model:
      - frameworks/pkg/proto.ViewerEndpoint
  PlaybackMetadata:
    model:
      - frameworks/pkg/proto.PlaybackMetadata
  PlaybackTrack:
    model:
      - frameworks/pkg/proto.PlaybackTrack
  PlaybackInstance:
    model:
      - frameworks/pkg/proto.PlaybackInstance

  # Stream meta types - bound to proto types
  StreamMetaResponse:
    model:
      - frameworks/pkg/proto.StreamMetaResponse
  MetaSummary:
    model:
      - frameworks/pkg/proto.MetaSummary
  TrackSummary:
    model:
      - frameworks/pkg/proto.TrackSummary

  # Billing types - bound to proto types
  BillingStatus:
    model:
      - frameworks/pkg/proto.BillingStatusResponse
  BillingTier:
    model:
      - frameworks/pkg/proto.BillingTier
  BillingFeatures:
    model:
      - frameworks/pkg/proto.BillingFeatures
  AllocationDetails:
    model:
      - frameworks/pkg/proto.AllocationDetails
  OverageRates:
    model:
      - frameworks/pkg/proto.OverageRates
  Invoice:
    model:
      - frameworks/pkg/proto.Invoice
  Payment:
    model:
      - frameworks/pkg/proto.PaymentResponse
  UsageRecord:
    model:
      - frameworks/pkg/proto.UsageRecord
  UsageSummary:
    model:
      - frameworks/pkg/proto.UsageSummary
  # TenantUsage, UsageEntry, CostEntry remain as model types
  # because proto.TenantUsageResponse uses map<string, double>
  # which doesn't map directly to GraphQL arrays

  # Infrastructure types - bound to proto types
  ServiceInstance:
    model:
      - frameworks/pkg/proto.ServiceInstance
  ServiceInstanceHealth:
    model:
      - frameworks/pkg/proto.ServiceInstanceHealth
  NodeMetric:
    model:
      - frameworks/pkg/proto.NodeMetric
  TimeRange:
    model:
      - frameworks/pkg/proto.TimeRange
  Cluster:
    model:
      - frameworks/pkg/proto.InfrastructureCluster
  Node:
    model:
      - frameworks/pkg/proto.InfrastructureNode

  # Tenant types - bound to proto types
  Tenant:
    model:
      - frameworks/pkg/proto.Tenant
  User:
    model:
      - frameworks/pkg/proto.User
  DeveloperToken:
    model:
      - frameworks/pkg/proto.APITokenInfo
  BootstrapToken:
    model:
      - frameworks/pkg/proto.BootstrapToken

  Money:
    model:
      - github.com/99designs/gqlgen/graphql.Float
  Currency:
    model:
      - github.com/99designs/gqlgen/graphql.String


# Skip generation for these types (we'll implement them manually)
skip_validation: true
