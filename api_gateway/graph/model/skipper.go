package model

import "time"

// SkipperChatEvent is the interface for the SkipperChatEvent GraphQL union.
type SkipperChatEvent interface {
	IsSkipperChatEvent()
}

type SkipperToken struct {
	Content string `json:"content"`
}

func (SkipperToken) IsSkipperChatEvent() {}

type SkipperToolStartEvent struct {
	Tool string `json:"tool"`
}

func (SkipperToolStartEvent) IsSkipperChatEvent() {}

type SkipperToolEndEvent struct {
	Tool  string  `json:"tool"`
	Error *string `json:"error"`
}

func (SkipperToolEndEvent) IsSkipperChatEvent() {}

type SkipperMeta struct {
	Confidence    string             `json:"confidence"`
	Citations     []*SkipperCitation `json:"citations"`
	ExternalLinks []*SkipperCitation `json:"externalLinks"`
	Details       []*SkipperToolDet  `json:"details"`
}

func (SkipperMeta) IsSkipperChatEvent() {}

type SkipperCitation struct {
	Label string `json:"label"`
	URL   string `json:"url"`
}

type SkipperToolDet struct {
	Title   string `json:"title"`
	Payload any    `json:"payload"`
}

type SkipperDone struct {
	ConversationID string `json:"conversationId"`
	TokensInput    int    `json:"tokensInput"`
	TokensOutput   int    `json:"tokensOutput"`
}

func (SkipperDone) IsSkipperChatEvent() {}

type SkipperConversation struct {
	ID        string            `json:"id"`
	Title     string            `json:"title"`
	Messages  []*SkipperMessage `json:"messages"`
	CreatedAt time.Time         `json:"createdAt"`
	UpdatedAt time.Time         `json:"updatedAt"`
}

type SkipperConversationSummary struct {
	ID        string    `json:"id"`
	Title     string    `json:"title"`
	CreatedAt time.Time `json:"createdAt"`
	UpdatedAt time.Time `json:"updatedAt"`
}

type SkipperMessage struct {
	ID           string    `json:"id"`
	Role         string    `json:"role"`
	Content      string    `json:"content"`
	Confidence   *string   `json:"confidence"`
	Sources      any       `json:"sources"`
	ToolsUsed    any       `json:"toolsUsed"`
	TokensInput  int       `json:"tokensInput"`
	TokensOutput int       `json:"tokensOutput"`
	CreatedAt    time.Time `json:"createdAt"`
}

// SkipperChatInput is the input for the skipperChat subscription.
// Will be regenerated by gqlgen â€” this ensures the resolvers compile before codegen.
type SkipperChatInput struct {
	ConversationID *string      `json:"conversationId"`
	Message        string       `json:"message"`
	PageURL        *string      `json:"pageUrl"`
	Mode           *SkipperMode `json:"mode"`
}

// SkipperMode enum for chat mode selection.
type SkipperMode string

const (
	SkipperModeDefault SkipperMode = "DEFAULT"
	SkipperModeDocs    SkipperMode = "DOCS"
)
