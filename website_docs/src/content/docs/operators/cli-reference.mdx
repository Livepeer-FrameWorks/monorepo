---
title: "CLI Command Reference"
description: "Complete reference for all FrameWorks CLI commands."
sidebar:
  order: 6
---

import { Aside } from "@astrojs/starlight/components";

The FrameWorks CLI is your swiss-army knife for platform management. Provisioning uses Ansible for some infrastructure tasks, while most commands run direct SSH or API calls.

<Aside type="tip">
  Use `frameworks menu` to launch an interactive menu for exploring these commands.
</Aside>

## Global Flags

```bash
--config string     Config file (default: $HOME/.frameworks/config.yaml)
--output string     Output format: json|text (default: text)
--verbose, -v       Enable verbose logging
--context string    Context name (default: "default")
```

Note: The `--manifest` flag is used by cluster subcommands and `frameworks edge provision` only. It is not global.

## Detection & Health Commands

### frameworks cluster detect

Detect the current state of all services in the cluster using multi-method detection.

**Usage:**

```bash
frameworks cluster detect [flags]
```

**Detection Methods:**

1. Check inventory file (`/etc/frameworks/inventory.json`)
2. Check Docker containers
3. Check systemd services
4. Check listening ports
5. Try health endpoints
6. Try direct connections (DB, Kafka, etc.)

**Output:**

```
✓ commodore (central-01): running [docker, v0.0.0-rc1, detected by: health-endpoint]
✓ postgres (central-01): running [docker, v15.2, detected by: port-check]
✗ signalman (regional-01): not found
```

**Flags:**

- `--manifest string` - Cluster manifest file (default: cluster.yaml)

**Examples:**

```bash
# Detect all services
frameworks cluster detect

# Detect with custom manifest
frameworks cluster detect --manifest production.yaml

# Verbose output
frameworks cluster detect --verbose
```

---

### frameworks cluster doctor

Run comprehensive health checks across the entire cluster.

**Usage:**

```bash
frameworks cluster doctor [flags]
```

**Checks:**

- **Infrastructure:** Postgres/Yugabyte, ClickHouse, and Kafka broker connectivity
- **Applications:** Health endpoints for enabled services
- **Interfaces:** Health endpoints for enabled interfaces
- **Observability:** Health endpoints for enabled observability services

Note: This command does not validate schemas or run mesh checks.

**Output:**

```
Infrastructure Health:

✓ Postgres/Yugabyte   : healthy (queries: 1.2ms avg)
✓ ClickHouse          : healthy (queries: 0.8ms avg)
✓ Kafka Broker 1      : healthy
✓ Kafka Broker 2      : healthy

Application Services:

✓ commodore           : healthy
✓ bridge              : healthy
✗ signalman           : connection refused

Summary: 7/8 checks passed

Recommendations:
  - Check failed services with: frameworks cluster detect
  - Review service logs for errors
  - Verify network connectivity between hosts
```

**Flags:**

- `--manifest string` - Cluster manifest file

**Examples:**

```bash
# Full health check
frameworks cluster doctor

# With verbose output
frameworks cluster doctor --verbose
```

---

## Provisioning Commands

### frameworks cluster provision

Deploy services to hosts based on the cluster manifest.

**Usage:**

```bash
frameworks cluster provision [flags]
```

**Deployment Modes:**

- **Docker:** Uses docker-compose files (default for most services)
- **Native:** Uses systemd units (for services with native binaries)

**Process:**

1. Load the cluster manifest and build an execution plan
2. Generate configuration files (docker-compose.yml or systemd units)
3. Transfer files to target hosts via SSH and provision (Ansible for some infra)
4. Start services
5. Validate health (unless `--ignore-validation`)

**Flags:**

- `--manifest string` - Cluster manifest file
- `--only string` - Phase to provision (`infrastructure`, `applications`, `interfaces`, `all`)
- `--dry-run` - Show what would be deployed without actually deploying
- `--force` - Force re-provision even if services exist
- `--ignore-validation` - Continue even if health validation fails (dangerous)

**Examples:**

```bash
# Provision entire cluster
frameworks cluster provision

# Provision only infrastructure
frameworks cluster provision --only infrastructure

# Provision only applications
frameworks cluster provision --only applications

# Preview changes
frameworks cluster provision --dry-run
```

**Bootstrap Flow:**

During provisioning, the CLI automatically bootstraps the system tenant and clusters:

1. **Service Token Required:** Set `SERVICE_TOKEN` or log in with `frameworks login` so the CLI can authenticate to Quartermaster.

2. **System Tenant Creation:** If the "FrameWorks" system tenant doesn't exist, it's created with deployment tier `global`.

3. **Cluster Registration:**
   - If the manifest has a `clusters` section, one cluster record is created per entry. Cluster IDs come from the manifest keys (e.g., `prod-control`, `prod-media`).
   - If there is no `clusters` section, a single cluster is created with ID `{type}-{profile}` (e.g., `cluster-production`).
   - Each cluster is registered with its `name`, `type`, and base URL derived from Bridge (if present) or Quartermaster.

4. **Node Registration:** Each host is registered under the cluster(s) its services belong to. The CLI resolves cluster assignment per service using role-based matching (see [Cluster Manifest: clusters](/operators/cluster-manifest#clusters)).

5. **Infrastructure Bootstrap Tokens:** One token is generated per cluster:
   - Kind: `infrastructure_node`
   - TTL: 720 hours (30 days)
   - Usage limit not set (defaults to single-use until used)

**Important:** When using `clusters`, IDs are explicit from the manifest. When not using `clusters`, the auto-generated format `{type}-{profile}` applies. These IDs are needed when using:

- `admin bootstrap-tokens create --cluster-id`
- `services discover --cluster-id`

To discover existing cluster IDs after provisioning:

```bash
frameworks admin clusters list
```

---

### frameworks cluster init

Initialize databases and create required schemas/tables.

**Usage:**

```bash
frameworks cluster init [service] [flags]
```

**Initialization:**

- Creates PostgreSQL databases and schemas
- Creates ClickHouse databases and tables
- Creates Kafka topics
- Applies embedded schemas and static seeds (per service)

**Flags:**

- `--manifest string` - Cluster manifest file

**Examples:**

```bash
# Initialize everything
frameworks cluster init all

# Initialize just Postgres
frameworks cluster init postgres --manifest production.yaml
```

---

## Operations Commands

### frameworks cluster logs

View or stream service logs.

**Usage:**

```bash
frameworks cluster logs <service> [flags]
```

**Supports:**

- Docker Compose logs (`docker compose logs`)
- Systemd journal logs (`journalctl -u`)

**Flags:**

- `--manifest string` - Cluster manifest file
- `--follow, -f` - Follow log output (stream)
- `--tail, -n int` - Number of lines to show (default: 50)

**Examples:**

```bash
# View last 50 lines (default)
frameworks cluster logs commodore

# Stream logs
frameworks cluster logs commodore --follow

# Show last 500 lines
frameworks cluster logs bridge --tail 500

# Show last 100 lines and follow
frameworks cluster logs decklog -n 100 -f
```

---

### frameworks cluster restart

Restart services with optional health validation.

**Usage:**

```bash
frameworks cluster restart <service> [flags]
```

**Process:**

1. Stop service gracefully
2. Wait for shutdown
3. Start service
4. Validate health (if enabled)

**Flags:**

- `--manifest string` - Cluster manifest file
- `--validate` - Validate service health after restart

**Examples:**

```bash
# Restart with health check
frameworks cluster restart commodore

# Restart with health validation
frameworks cluster restart bridge --validate
```

---

### frameworks cluster upgrade

Upgrade services to new versions from GitOps manifests.

**Usage:**

```bash
frameworks cluster upgrade <service> [flags]
```

**Version Resolution:**

- `stable` - Latest stable release
- `rc` - Latest release candidate
- `v0.0.0-rc1` - Specific version tag

**Process:**

1. Detect current state
2. Fetch GitOps manifest for target version
3. Stop service
4. Deploy new version (pull image or download binary)
5. Start service
6. Validate health

**Flags:**

- `--manifest string` - Cluster manifest file
- `--version string` - Target version (default: `stable`)
- `--dry-run` - Preview upgrade without executing
- `--skip-validation` - Skip health validation after upgrade
- `--yes` - Skip confirmation prompt
- `--no-rollback` - Skip automatic rollback on health check failure

**Examples:**

```bash
# Upgrade to latest stable
frameworks cluster upgrade commodore --version stable

# Upgrade to specific version
frameworks cluster upgrade bridge --version v0.0.0-rc1

# Preview upgrade
frameworks cluster upgrade signalman --version stable --dry-run

# Upgrade without validation
frameworks cluster upgrade decklog --version stable --skip-validation
```

<Aside type="caution" title="Database schema changes">
  Service upgrades may require schema migrations. For ClickHouse changes, apply `ALTER TABLE`
  statements **before** upgrading services. See [ClickHouse
  Migrations](/operators/clickhouse-migrations).
</Aside>

---

## Backup & Restore Commands

### frameworks cluster backup

Backup cluster components to local storage.

**Usage:**

```bash
frameworks cluster backup <component> [flags]
```

**Components:**

- `postgres` - PostgreSQL/YugabyteDB dump (pg_dumpall)
- `clickhouse` - ClickHouse databases (TSV format)
- `volumes` - Docker volumes (tar.gz archives)
- `config` - Configuration files (.env, docker-compose.yml, /etc/frameworks)
- `all` - Backup everything

**Output:**

- Files stored in the output directory with timestamps
- Timestamped filenames: `postgres-YYYYMMDD-HHMMSS` database dump format

**Flags:**

- `--manifest string` - Cluster manifest file
- `--output string` - Output directory (default: `./backups`)
- `--skip-upload` - Placeholder only (uploads are not wired yet)

**Examples:**

```bash
# Backup everything
frameworks cluster backup all --output /backups

# Backup only Postgres
frameworks cluster backup postgres --output /opt/backups

# Backup ClickHouse
frameworks cluster backup clickhouse --output /backups

# Backup volumes
frameworks cluster backup volumes --output /backups

# Backup config files
frameworks cluster backup config --output /backups
```

---

### frameworks cluster restore

Restore components from backup files.

**Usage:**

```bash
frameworks cluster restore <component> [flags]
```

**⚠️ Warning:** Restore will STOP services and OVERWRITE existing data!

**Components:**

- `postgres` - Restore from SQL dump
- `clickhouse` - Restore from TSV directory
- `volumes` - Restore from tar.gz archive
- `config` - Restore configuration files

**Flags:**

- `--manifest string` - Cluster manifest file
- `--from string` - Path to backup file or directory (required)
- `--skip-validation` - Skip health validation after restore
- `--yes` - Skip confirmation prompt

**Examples:**

```bash
# Restore Postgres
frameworks cluster restore postgres \
  --from /backups/2025-01-17/postgres-20250117-143000.sql

# Restore ClickHouse
frameworks cluster restore clickhouse \
  --from /backups/2025-01-17/clickhouse-20250117-143000/

# Restore volumes
frameworks cluster restore volumes \
  --from /backups/2025-01-17/volumes-20250117-143000.tar.gz

# Restore config
frameworks cluster restore config \
  --from /backups/2025-01-17/config-20250117-143000.tar.gz

# Restore without validation
frameworks cluster restore postgres \
  --from /backups/postgres.sql --skip-validation
```

---

## Diagnostic Commands

### frameworks cluster diagnose network

Test network connectivity between all hosts in the cluster.

**Usage:**

```bash
frameworks cluster diagnose network [flags]
```

**Tests:**

- Ping test from each host to every other host
- Reports success/failure matrix

**Output:**

```
Network Connectivity Diagnostics

✓ 10.0.1.10 → 10.0.1.11: OK
✓ 10.0.1.10 → 10.0.1.12: OK
✗ 10.0.1.11 → 10.0.1.12: FAILED (no response)
```

**Examples:**

```bash
frameworks cluster diagnose network
```

---

### frameworks cluster diagnose resources

Check CPU, memory, disk, and load average on all hosts.

**Usage:**

```bash
frameworks cluster diagnose resources [flags]
```

**Metrics:**

- CPU usage (%)
- Memory usage (used/total)
- Disk usage (/)
- Load average (1m, 5m, 15m)

**Output:**

```
Resource Usage Diagnostics

Host: central-01 (10.0.1.10)
  CPU: 23.5% used
  Memory: 4.2G / 16G (26.25%)
  Disk: 120G / 500G (24% used)
  Load: 0.45, 0.62, 0.71
```

**Examples:**

```bash
frameworks cluster diagnose resources
```

---

### frameworks cluster diagnose ports

Check for port conflicts on all hosts.

**Usage:**

```bash
frameworks cluster diagnose ports [flags]
```

**Checks Standard Ports:**
Uses the CLI's built-in port list for core services, interfaces, and gRPC endpoints. For the canonical port table, see [Architecture Overview](/operators/architecture#core-services).

**Output:**

```
Port Conflict Diagnostics

Host: central-01 (10.0.1.10)
  Port 5432 (Postgres): IN USE
  Port 9092 (Kafka): IN USE
  Port 18000 (Bridge): IN USE
  Port 18001 (Commodore): IN USE
```

**Examples:**

```bash
frameworks cluster diagnose ports
```

---

### frameworks cluster diagnose kafka

Check Kafka cluster health, topics, consumer groups, and broker status.

**Usage:**

```bash
frameworks cluster diagnose kafka [flags]
```

**Checks:**

- List all topics
- List consumer groups
- Broker API version check
- Cluster responsiveness

**Output:**

```
Kafka Diagnostics

Topics:
  analytics_events
  stream_commands
  routing_updates

Consumer Groups:
  periscope-ingest
  decklog-processor

Broker Status:
  ✓ Broker is responding
```

**Examples:**

```bash
frameworks cluster diagnose kafka
```

---

## DNS Commands

### frameworks dns doctor

Verify public DNS records match Quartermaster inventory.

**Usage:**

```bash
frameworks dns doctor --domain example.com
```

Compares expected IPs from node inventory against actual DNS resolution. Useful for verifying Navigator has synced DNS records correctly.

---

## Mesh Commands

### frameworks mesh status

Show WireGuard mesh status from Quartermaster inventory.

**Usage:**

```bash
frameworks mesh status
```

Displays node IDs, roles, internal/WireGuard IPs, last heartbeat, and agent status. Useful for verifying Privateer mesh connectivity.

---

## Admin Commands

### frameworks admin tokens

Manage developer API tokens.

**Subcommands:**

```bash
# Create a token
frameworks admin tokens create --name "my-app" --expires 720h --perms "read:streams,write:streams"

# List tokens (shows name and ID)
frameworks admin tokens list

# Revoke by name (preferred)
frameworks admin tokens revoke --name "my-app"

# Revoke by ID
frameworks admin tokens revoke <token-id>
```

**Flags for create:**

- `--name` - Token name/label (required)
- `--expires` - Expiry duration (e.g., `720h`, `30d`)
- `--perms` - Comma-separated permissions

Note: Permissions are accepted but not enforced yet. API tokens currently grant full access until RBAC lands.

---

### frameworks admin bootstrap-tokens

Manage bootstrap tokens for edge node enrollment.

**Subcommands:**

```bash
# Create bootstrap token
frameworks admin bootstrap-tokens create --name "edge-nyc-01" --kind edge_node --ttl 24h

# List tokens (shows name and ID)
frameworks admin bootstrap-tokens list

# Revoke by name (preferred)
frameworks admin bootstrap-tokens revoke --name "edge-nyc-01"

# Revoke by ID
frameworks admin bootstrap-tokens revoke <token-id>
```

**Flags for create:**

- `--name` - Display name (required)
- `--kind` - Token kind: `edge_node`, `service`, or `infrastructure_node` (default: `edge_node`)
- `--ttl` - Time-to-live (e.g., `24h`, `7d`) (default: `24h`)
- `--tenant-id` - Tenant ID (required for `edge_node`)
- `--cluster-id` - Cluster ID (required for `edge_node`)
- `--expected-ip` - Expected client IP for validation (optional)
- `--usage-limit` - Maximum uses; omit or set `0` for single use

---

### frameworks admin tenants

List and manage tenants.

```bash
# List all tenants (shows name and ID)
frameworks admin tenants list
```

**Sample output:**

```
Tenants (2)
 - FrameWorks (id=abc123-...) tier=global
 - Acme Corp (id=def456-...) tier=standard
```

---

### frameworks admin clusters

List and manage clusters.

**Subcommands:**

- `list` - List clusters
- `create` - Create a cluster
- `update` - Update a cluster
- `access` - Manage tenant access (`list`, `grant`)
- `invites` - Manage invites (`create`, `list`, `revoke`, `list-mine`, `accept`)
- `subscriptions` - List cluster subscriptions

```bash
# List all clusters (shows name and ID)
frameworks admin clusters list

# Create a cluster
frameworks admin clusters create \
  --cluster-id central-production \
  --cluster-name "FrameWorks Central Production" \
  --cluster-type central \
  --base-url http://10.0.1.10:18002

# Create a cluster and claim Foghorn instances from the pool
frameworks admin clusters create \
  --cluster-id edge-eu \
  --cluster-name "EU Edge Cluster" \
  --cluster-type cluster \
  --base-url eu.frameworks.network \
  --foghorn-count 2

# Update a cluster
frameworks admin clusters update --cluster-id central-production --is-active
```

**Sample output:**

```
Clusters (2)
 - FrameWorks Central Production (id=central-production) type=central url=http://10.0.1.10:18002
 - FrameWorks Regional EU (id=regional-eu) type=regional url=http://10.1.1.10:18002
```

**Note:** Cluster IDs are either explicit (from the `clusters` section of your manifest) or auto-generated as `{type}-{profile}` when no `clusters` section is defined.

---

### frameworks admin foghorn-pool

Manage the Foghorn instance pool across clusters.

**Subcommands:**

```bash
# Show pool status (total, assigned, unassigned per cluster)
frameworks admin foghorn-pool status

# Release instances back to the pool
frameworks admin foghorn-pool add --instance-id <uuid>
frameworks admin foghorn-pool add --count 2 --from-cluster <cluster-id>

# Drain a Foghorn instance from its cluster
frameworks admin foghorn-pool drain --instance-id <uuid>

# Assign Foghorn(s) to a cluster (many-to-many)
frameworks admin foghorn-pool assign --cluster-id <id> --count 1
frameworks admin foghorn-pool assign --cluster-id <id> --instance-id <uuid>

# Remove Foghorn(s) from a cluster
frameworks admin foghorn-pool unassign --cluster-id <id> --instance-id <uuid>
```

**Flags for `add`:**

- `--instance-id` - Instance UUID(s) to release (repeatable)
- `--count` - Number of instances to release from cluster
- `--from-cluster` - Cluster to release instances from

Requires either `--instance-id` or both `--count` and `--from-cluster`.

**Flags for `assign`:**

- `--cluster-id` - Cluster to assign Foghorn(s) to (required)
- `--instance-id` - Specific Foghorn instance UUID(s) (repeatable)
- `--count` - Pick N least-loaded Foghorn instances

**Flags for `unassign`:**

- `--cluster-id` - Cluster to unassign from (required)
- `--instance-id` - Foghorn instance UUID(s) to remove (required)

**Flags for `drain`:**

- `--instance-id` - Instance UUID to drain (required)

---

### frameworks admin clusters create-edge

Create an edge cluster with automatic Foghorn assignment and enrollment token.

```bash
frameworks admin clusters create-edge --cluster-name "My Edge" --tenant-id <uuid>
```

**Flags:**

- `--cluster-name` - Display name for the cluster (required)
- `--tenant-id` - Tenant ID (defaults to JWT tenant)
- `--description` - Short description

---

### frameworks admin clusters enrollment-token

Create an enrollment token for an existing cluster (requires active subscription).

```bash
frameworks admin clusters enrollment-token --cluster-id <id> --ttl 7d
```

**Flags:**

- `--cluster-id` - Cluster ID (required)
- `--tenant-id` - Tenant ID (defaults to JWT tenant)
- `--name` - Token display name
- `--ttl` - Time-to-live (e.g. `24h`, `7d`; default 30d)

---

### frameworks admin clusters cert-status

Show cluster readiness including health, Foghorn instances, and certificate status.

```bash
frameworks admin clusters cert-status --cluster-id <cluster-id>
```

**Flags:**

- `--cluster-id` - Cluster ID (required)

**Output includes:** cluster name, type, base URL, health status, registered Foghorn instances with status, and certificate readiness.

---

### frameworks admin billing

Billing tier and subscription management.

**Subcommands:**

- `tiers` - List billing tiers (shows default prepaid/postpaid flags)
- `init-postpaid` - Initialize postpaid billing for a tenant (resolves default postpaid tier, provisions cluster access)
- `promote` - Promote tenant from prepaid to postpaid billing (re-evaluates cluster subscriptions)

```bash
# List billing tiers
frameworks admin billing tiers

# Initialize postpaid account for a tenant
frameworks admin billing init-postpaid --tenant-id <UUID>

# Promote prepaid tenant to postpaid
frameworks admin billing promote --tenant-id <UUID>
```

---

### frameworks admin nodes

List registered infrastructure nodes.

**Subcommands:**

- `list` - List nodes
- `create` - Create/register a node record
- `hardware` - Update hardware metadata (cpu/mem/disk)

```bash
# List all nodes
frameworks admin nodes list

# Filter by cluster
frameworks admin nodes list --cluster-id cluster-production

# Filter by type
frameworks admin nodes list --type edge

# Filter by region
frameworks admin nodes list --region us-east-1

# Create a node
frameworks admin nodes create \
  --node-name edge-nyc-01 \
  --node-type edge \
  --cluster-id central-production

# Update hardware metadata
frameworks admin nodes hardware --node-id edge-nyc-01 --cpu-cores 16 --memory-gb 64 --disk-gb 2000
```

**Flags:**

- `--cluster-id` - Filter by cluster ID
- `--type` - Filter by node type (common: `edge`, `core`; some deployments use `regional`/`central`)
- `--region` - Filter by region

---

## Edge Commands

Edge node lifecycle operations. Most commands support `--ssh user@host` (and `--ssh-key`) for remote execution.

### frameworks edge preflight

Check host readiness (DNS, ports, sysctl, ulimits).

```bash
# Check all requirements
frameworks edge preflight

# Include DNS validation for a specific domain
frameworks edge preflight --domain edge1.example.com
```

**Flags:**

- `--domain` - Edge domain to validate DNS for

---

### frameworks edge tune

Apply recommended sysctl and ulimit settings for streaming workloads.

```bash
# Preview changes (writes local preview files)
frameworks edge tune

# Apply changes system-wide (requires sudo)
frameworks edge tune --write
```

**Flags:**

- `--write` - Write to system paths (requires sudo)
- `--sysctl-path` - Target sysctl path (default: `/etc/sysctl.d/frameworks-edge.conf`)
- `--limits-path` - Target limits path (default: `/etc/security/limits.d/frameworks-edge.conf`)

**Tuning Applied:**

- `net.core.rmem_max = 16777216`
- `net.core.wmem_max = 16777216`
- `net.core.somaxconn = 8192`
- `net.ipv4.ip_local_port_range = 16384 65535`
- `* soft nofile = 1048576`
- `* hard nofile = 1048576`

---

### frameworks edge init

Generate edge node configuration files (edge env file, edge compose file, Caddy config file).

```bash
# With explicit domain
frameworks edge init --domain edge1.example.com --email admin@example.com

# With enrollment token (auto-assigns domain via PreRegisterEdge)
frameworks edge init --enrollment-token enroll_abc123 --email admin@example.com
```

When `--enrollment-token` is provided without `--domain`, the CLI calls `PreRegisterEdge` to get an auto-assigned domain, pool domain, and cluster configuration. The token carries tenant and cluster scope.

**Flags:**

- `--dir` - Target directory for templates (default: `.`)
- `--domain` - Edge domain to configure
- `--enrollment-token` - Enrollment token issued by FrameWorks for node bootstrap
- `--email` - ACME email for Let's Encrypt certificate issuance
- `--overwrite` - Overwrite existing files

---

### frameworks edge enroll

Start the edge stack and verify HTTPS readiness. The bootstrap token must be set in the edge environment file as `EDGE_ENROLLMENT_TOKEN`.

```bash
# Enroll edge node (token read from edge environment file)
frameworks edge enroll

# From a specific directory
frameworks edge enroll --dir /opt/frameworks-edge

# Run remotely via SSH
frameworks edge enroll --dir /opt/frameworks-edge --ssh admin@edge1.example.com
```

**Flags:**

- `--dir` - Directory containing the edge compose and environment files
- `--timeout` - Maximum time to wait for HTTPS readiness (default: `2m`)
- `--ssh` - Run remotely on `user@host` via SSH
- `--ssh-key` - SSH private key path

**Note:** This command starts Caddy, MistServer, and Helmsman, then waits for HTTPS to become available.

---

### frameworks edge provision

Orchestrate full edge node provisioning (preflight, tune, register, init, enroll).

**Usage:**

```bash
# Single node provisioning
frameworks edge provision --ssh user@host [flags]

# Multi-node provisioning from manifest
frameworks edge provision --manifest edges.yaml
```

**Process:**

1. Run preflight checks
2. Apply system tuning (optional)
3. Register node in Quartermaster (optional)
4. Fetch TLS certificate from Navigator (optional)
5. Generate and upload templates
6. Start edge stack
7. Verify HTTPS readiness

**Flags:**

- `--ssh string` - SSH target (user@host)
- `--ssh-key` - SSH private key path
- `--pool-domain string` - Shared LB pool domain (e.g., edge.example.com)
- `--node-domain string` - Individual node domain
- `--node-name string` - Node name for registration
- `--cluster-id string` - Cluster ID for registration
- `--region string` - Region identifier
- `--email string` - ACME email for certificates
- `--timeout` - HTTPS readiness timeout (default: `3m`)
- `--enrollment-token string` - Enrollment token for auto-provisioning (skips explicit domain flags)
- `--manifest string` - Path to edge manifest file
- `--parallel int` - Number of concurrent provisions (default: 1)
- `--tune` - Apply sysctl/limits tuning
- `--register` - Register node in Quartermaster
- `--fetch-cert` - Fetch TLS certificate from Navigator
- `--skip-preflight` - Skip preflight checks

**Examples:**

```bash
# Provision single node with explicit domains
frameworks edge provision --ssh ubuntu@10.0.0.5 \
  --pool-domain edge.example.com \
  --node-domain edge-1.example.com \
  --register --fetch-cert --email admin@example.com

# Provision with enrollment token (auto-assigns domain via PreRegisterEdge)
frameworks edge provision --ssh ubuntu@10.0.0.5 \
  --enrollment-token enroll_abc123 \
  --email admin@example.com

# Provision from manifest
frameworks edge provision --manifest edges.yaml --parallel 4
```

When `--enrollment-token` is provided without `--pool-domain` and `--node-domain`, the CLI calls `PreRegisterEdge` to validate the token and get auto-assigned domains, certificates, and cluster routing information.

---

### frameworks edge status

Check edge node container status and HTTPS health.

```bash
frameworks edge status
frameworks edge status --domain edge1.example.com --ssh admin@edge1.example.com
```

**Flags:**

- `--dir` - Directory with compose/env files
- `--domain` - Override `EDGE_DOMAIN` from env file
- `--ssh` - Run remotely via SSH
- `--ssh-key` - SSH private key path

---

### frameworks edge update

Update edge node software to latest version.

```bash
frameworks edge update
frameworks edge update --ssh admin@edge1.example.com
```

**Flags:**

- `--dir` - Directory
- `--ssh` - Run remotely via SSH
- `--ssh-key` - SSH private key path

---

### frameworks edge cert

Check and manage TLS certificates.

```bash
frameworks edge cert --domain edge1.example.com
frameworks edge cert --reload  # Reload Caddy after check
```

**Flags:**

- `--dir` - Directory
- `--domain` - Domain to check
- `--reload` - Reload Caddy after certificate check
- `--ssh` - Run remotely via SSH
- `--ssh-key` - SSH private key path

---

### frameworks edge logs

View edge service logs.

```bash
frameworks edge logs
frameworks edge logs --follow --tail 500
```

**Flags:**

- `--dir` - Directory
- `--follow` - Follow/tail logs
- `--tail` - Number of lines to show
- `--ssh` - Run remotely via SSH
- `--ssh-key` - SSH private key path

---

### frameworks edge doctor

Run comprehensive health checks on the edge node.

```bash
frameworks edge doctor --domain edge1.example.com
```

**Flags:**

- `--dir` - Directory
- `--domain` - Domain to check
- `--ssh` - Run remotely via SSH
- `--ssh-key` - SSH private key path

---

## Services Commands

Central-tier service operations (for single-host or development deployments).

### frameworks services plan

Generate central-tier compose fragments and a `.central.env` file.

```bash
# Generate with default profile
frameworks services plan

# Use a specific profile
frameworks services plan --profile control-core

# Interactive service selection
frameworks services plan --interactive

# Include/exclude specific services
frameworks services plan --include commodore,quartermaster --exclude purser
```

**Output:**

- Service fragment files (one per service)
- `.central.env` (merged env file)

**Flags:**

- `--profile` - Preset: `central-all` | `control-core` | `routing-only` | `analytics-suite` | `billing-only` (default: `central-all`)
- `--include` - Comma-separated services to include
- `--exclude` - Comma-separated services to exclude
- `--dir` - Target directory for generated files (default: `.`)
- `--overwrite` - Overwrite existing files
- `--interactive` - Interactive checkbox selection
- `--config-base` - Path to base env file (default: `config/env/base.env`)
- `--config-secrets` - Path to secrets env file (default: `config/env/secrets.env`)
- `--env-output` - Path for generated env file (default: `<dir>/.central.env`)
- `--env-context` - Value for `ENV_CONTEXT` (default: `central`)

---

### frameworks services up

Start central services.

```bash
frameworks services up
frameworks services up --only commodore,quartermaster
frameworks services up --ssh admin@central-01
```

**Flags:**

- `--dir` - Directory containing generated compose files
- `--only` - Comma-separated services to start
- `--ssh` - Run remotely on `user@host` via SSH
- `--ssh-key` - SSH private key path

---

### frameworks services down

Stop central services.

```bash
frameworks services down
frameworks services down --only commodore
```

**Flags:**

- `--dir` - Directory containing generated compose files
- `--only` - Comma-separated services to stop
- `--ssh` - Run remotely via SSH
- `--ssh-key` - SSH private key path

---

### frameworks services status

Show container status for running services.

```bash
frameworks services status
frameworks services status --only commodore,bridge
```

**Flags:**

- `--dir` - Directory containing generated compose files
- `--only` - Comma-separated services to filter
- `--ssh` - Run remotely via SSH
- `--ssh-key` - SSH private key path

---

### frameworks services logs

View service logs.

```bash
frameworks services logs
frameworks services logs --only commodore --follow --tail 500
```

**Flags:**

- `--dir` - Directory containing generated compose files
- `--only` - Comma-separated services to filter
- `--follow` - Follow/tail logs
- `--tail` - Number of lines to show (default: `200`)
- `--ssh` - Run remotely via SSH
- `--ssh-key` - SSH private key path

---

### frameworks services health

Show aggregated service health from Quartermaster.

```bash
# All services
frameworks services health

# Filter by service type
frameworks services health --type commodore

# Filter by specific service ID
frameworks services health --service-id commodore-prod-01
```

**Flags:**

- `--service-id` - Filter by service ID
- `--type` - Filter by service type (catalog name)

---

### frameworks services discover

Query service discovery endpoints.

```bash
frameworks services discover --type commodore
frameworks services discover --type foghorn --cluster-id central-production
```

**Flags:**

- `--type` - Service type/catalog name (required)
- `--cluster-id` - Filter by cluster ID

---

## Context Commands

Manage CLI contexts (endpoints, authentication, executor settings).

### frameworks context init

Create a default configuration with local development endpoints.

```bash
frameworks context init
```

Creates the local CLI config with a "local" context pointing to `localhost` endpoints.

---

### frameworks context list

List available contexts.

```bash
frameworks context list
```

**Sample output:**

```
* local
  production
  staging
```

---

### frameworks context use

Switch to a different context.

```bash
frameworks context use production
```

---

### frameworks context show

Show details of a context.

```bash
# Show current context
frameworks context show

# Show specific context
frameworks context show production
```

---

### frameworks context set-cluster

Set the active cluster ID for the current context.

```bash
frameworks context set-cluster <cluster-id>
```

This determines which cluster subsequent commands operate against.

---

### frameworks context set-url

Update a service endpoint URL.

```bash
frameworks context set-url bridge http://bridge.example.com:18000
frameworks context set-url quartermaster http://central.example.com:18002
```

Valid service keys: `bridge`, `quartermaster`, `commodore`, `foghorn`, `periscope-query`, `periscope-ingest`, `purser`, `signalman-ws`, `commodore-grpc`, `quartermaster-grpc`, `purser-grpc`, `periscope-grpc`, `signalman-grpc`, `foghorn-grpc`, `decklog-grpc`, `navigator-grpc`.

---

### frameworks context check

Check connectivity to all endpoints in the current context.

```bash
frameworks context check
```

---

## Authentication Commands

### frameworks login

Authenticate with the FrameWorks platform.

```bash
# Login with API token (for user operations)
frameworks login

# Login with service token (for automation)
frameworks login --service-account
```

**Flags:**

- `--service-account` - Use service token instead of API token

Tokens are stored in `~/.frameworks/.env` and never appear in shell history.

---

## Utility Commands

### frameworks version

Print CLI and platform version info.

```bash
frameworks version
```

---

### frameworks menu

Launch interactive menu for common operations.

```bash
frameworks menu
```

Provides a guided interface for:

- Edge Operations
- Services & Health
- Control Plane (Admin)
- Cluster Operations
- DNS & Mesh
- Settings & Contexts

---

### frameworks config env

Generate a merged `.env` file from layered configuration.

```bash
# Generate .env in current directory
frameworks config env

# Custom base and secrets files
frameworks config env --base config/env/base.env --secrets config/env/secrets.env

# Output to stdout
frameworks config env --output -

# Specify context
frameworks config env --context production
```

**Flags:**

- `--base` - Path to base env file (default: `config/env/base.env`)
- `--secrets` - Path to secrets env file (default: `config/env/secrets.env`)
- `--output` - Output path (default: `.env`, use `-` for stdout)
- `--context` - Value for `ENV_CONTEXT` (default: `dev`)

---

## Exit Codes

- `0` - Success
- `1` - General error
- `2` - Invalid arguments
- `3` - Service not found
- `4` - Connection error
- `5` - Health check failed
